(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[669],{4705:function(e,s,l){Promise.resolve().then(l.bind(l,9927))},9927:function(e,s,l){"use strict";l.d(s,{default:function(){return m}});var t=l(7437),r=l(2265),n=l(1169);function a(e){let{isVisible:s,onClose:l,children:r,label:n}=e;return s?(0,t.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-darkpurple bg-opacity-50 backdrop-blur-sm"}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-lg z-10 relative max-w-[70vw]",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"text-2xl text-lightpurple m-0 flex items-center",children:n}),"login"===n?(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)("span",{className:"text-4xl material-symbols-sharp",children:"account_circle"})}):(0,t.jsx)("button",{onClick:l,className:"text-2xl text-darkpurple cursor-pointer hover:text-lightpurple flex items-center",children:(0,t.jsx)("span",{className:"material-symbols-sharp",children:"close"})})]}),r]})]}):null}function i(e){let{toggleSidebar:s,handleLogout:l}=e,[i,c]=(0,r.useState)(!1),[o,m]=(0,r.useState)(!1),[d,u]=(0,r.useState)(null),h=(0,n.useRouter)();(0,r.useEffect)(()=>{let e=localStorage.getItem("username");e&&u(e)},[]);let p=()=>{c(!i)},x=()=>{m(!o)},g=e=>{"LOGOUT"===e?l():"CATALOGUE REQUEST"===e?h.push("/customers/catalogueRequest"):"ORDER"===e&&h.push("/customers/newOrder"),c(!1),m(!1)};return(0,t.jsxs)("header",{className:"col-span-12 bg-darkpurple text-white p-4 flex justify-between items-center",children:[(0,t.jsx)("div",{children:(0,t.jsx)("span",{className:"material-symbols-sharp text-3xl cursor-pointer hover:text-lightpurple",onClick:s,children:"menu"})}),(0,t.jsx)("div",{children:(0,t.jsx)("h2",{className:"font-serif text-2xl font-semibold",children:"Bloms Bulbs"})}),(0,t.jsx)("nav",{className:"hidden sm:block",children:(0,t.jsx)("h2",{className:"font-semibold cursor-pointer hover:text-lightpurple",onClick:()=>{h.push("/")},children:"HOME"})}),(0,t.jsx)("nav",{className:"hidden sm:block",children:(0,t.jsx)("h2",{className:"font-semibold cursor-pointer hover:text-lightpurple",onClick:x,children:"NEW"})}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("div",{className:"px-4",children:[(0,t.jsx)("p",{children:"hello"}),(0,t.jsx)("p",{className:"text-lightpurple text-sm",children:d})]}),(0,t.jsx)("div",{className:"mr-4",children:(0,t.jsx)("span",{className:"material-symbols-sharp text-3xl cursor-pointer hover:text-lightpurple",onClick:p,children:"account_circle"})})]}),(0,t.jsx)(a,{isVisible:i,onClose:p,label:"account",children:(0,t.jsxs)("div",{className:"flex flex-col items-start py-2 mr-4 text-black",children:[(0,t.jsx)("button",{onClick:()=>g("MANAGE ACCOUNT"),className:"py-2 hover:text-lightpurple",children:"MANAGE ACCOUNT"}),(0,t.jsx)("button",{onClick:()=>g("LOGOUT"),className:"py-2 hover:text-lightpurple",children:"LOGOUT"})]})}),(0,t.jsx)(a,{isVisible:o,onClose:x,label:"new",children:(0,t.jsxs)("div",{className:"flex flex-col items-start py-2 mr-4 text-black",children:[(0,t.jsx)("button",{onClick:()=>g("CATALOGUE REQUEST"),className:"py-2 hover:text-lightpurple",children:"CATALOGUE REQUEST"}),(0,t.jsx)("button",{onClick:()=>g("ORDER"),className:"py-2 hover:text-lightpurple",children:"ORDER"})]})})]})}function c(e){let{isVisible:s,onClose:l,onLogin:n}=e,[i,c]=(0,r.useState)(""),[o,m]=(0,r.useState)(""),[d,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)([]),[x,g]=(0,r.useState)([]),[f,j]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/fetchUserNames"),s=await e.json();p(s),console.log(s)}catch(e){console.error("Failed to fetch usernames",e)}})()},[]);let N=e=>{c(e),g([]),j(!0)},b=async e=>{e.preventDefault();let s=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,password:o})}),l=await s.json();s.ok?(console.log("Token received from API:",l.token),localStorage.setItem("token",l.token),localStorage.setItem("userId",l.userId),localStorage.setItem("username",l.username),localStorage.setItem("permissionLevel",l.permissionLevel),n()):u(!0)};return(0,t.jsx)(a,{isVisible:s,onClose:l,label:"login",children:(0,t.jsxs)("div",{className:"flex flex-col items-start py-2 mr-4",children:[(0,t.jsx)("p",{className:"text-md py-2",children:"Welcome to the Bloms Bulbs Admin Suite, please enter your username and password below. If you do not know your details, please contact an administrator."}),d&&(0,t.jsx)("p",{className:"text-sm text-red pb-2",children:"PLEASE CHECK YOUR USERNAME OR PASSWORD AND TRY AGAIN"}),(0,t.jsx)("div",{className:"flex",children:x.map(e=>(0,t.jsx)("span",{className:"bg-lightpurple rounded-sm text-md p-2 mr-2 mb-2 cursor-pointer hover:text-white",onClick:()=>N(e),children:e},e))}),(0,t.jsxs)("form",{className:"grid grid-cols-6 mt-2",onSubmit:b,children:[(0,t.jsxs)("div",{className:"col-span-1 flex items-center mb-2",children:[(0,t.jsx)("label",{children:"USERNAME"}),f&&(0,t.jsx)("span",{className:"material-symbols-outlined text-lightpurple ml-2",children:"check_circle"})]}),(0,t.jsx)("div",{className:"col-span-5 flex-items-center ml-4 mb-2",children:(0,t.jsx)("input",{type:"text",value:i,onChange:e=>{let s=e.target.value;if(u(!1),c(s),s.length>0){let e=h.filter(e=>e.toLowerCase().includes(s.toLowerCase()));g(e),e.includes(s.toLowerCase())?(j(!0),g([])):j(!1)}else g([]),j(!1)},className:"p-2 rounded-sm shadow-md border focus:outline-none focus:ring-2 focus:ring-lightpurple"})}),(0,t.jsx)("div",{className:"col-span-1 flex items-center",children:(0,t.jsx)("label",{children:"PASSWORD"})}),(0,t.jsx)("div",{className:"col-span-5 flex-items-center ml-4 mb-2",children:(0,t.jsx)("input",{type:"password",value:o,onChange:e=>{u(!1),m(e.target.value)},className:"p-2 rounded-sm shadow-md border focus:outline-none focus:ring-2 focus:ring-lightpurple"})}),(0,t.jsx)("button",{className:"bg-darkpurple text-white font-medium py-2 px-4 my-2 rounded-sm hover:bg-lightpurple",type:"submit",children:"LOGIN"})]})]})})}function o(){return(0,t.jsx)("div",{className:"col-span-12 sm:col-span-2 bg-lightpurple min-h-screen",children:(0,t.jsx)("h2",{children:"SIDEBAR"})})}function m(e){let{children:s}=e,[l,n]=(0,r.useState)(!1),[a,m]=(0,r.useState)(!1),[d,u]=(0,r.useState)(!0),[h,p]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{localStorage.getItem("token")&&(n(!0),u(!1),"1"===localStorage.getItem("permissionLevel")&&m(!0))},[]),(0,r.useEffect)(()=>{let e=()=>{window.innerWidth>=1024?p(!0):p(!1)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(0,t.jsxs)("div",{className:"grid grid-cols-12",children:[!l&&(0,t.jsx)(c,{isVisible:d,onClose:()=>{},onLogin:()=>{n(!0),u(!1);let e=localStorage.getItem("token");console.log("Token from localStorage:",e),e&&"1"===localStorage.getItem("permissionLevel")&&m(!0)}}),l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i,{toggleSidebar:()=>{p(!h)},handleLogout:()=>{n(!1),m(!1),localStorage.clear(),u(!0)}}),h&&(0,t.jsx)(o,{}),(0,t.jsx)("main",{className:"p-4 ".concat(h?"col-span-10":"col-span-12"),children:s})]})]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=4705)}),_N_E=e.O()}]);