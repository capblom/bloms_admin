(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[908],{4872:function(e,s,t){Promise.resolve().then(t.bind(t,2905))},9927:function(e,s,t){"use strict";t.d(s,{default:function(){return d}});var l=t(7437),n=t(2265),r=t(1169);function a(e){let{isVisible:s,onClose:t,children:n,label:r}=e;return s?(0,l.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-darkpurple bg-opacity-50 backdrop-blur-sm"}),(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-lg z-10 relative max-w-[70vw]",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("h3",{className:"text-2xl text-lightpurple m-0 flex items-center",children:r}),"login"===r?(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsx)("span",{className:"text-4xl material-symbols-sharp",children:"account_circle"})}):(0,l.jsx)("button",{onClick:t,className:"text-2xl text-darkpurple cursor-pointer hover:text-lightpurple flex items-center",children:(0,l.jsx)("span",{className:"material-symbols-sharp",children:"close"})})]}),n]})]}):null}function i(e){let{toggleSidebar:s,handleLogout:t}=e,[i,c]=(0,n.useState)(!1),[o,d]=(0,n.useState)(!1),[m,u]=(0,n.useState)(null),h=(0,r.useRouter)();(0,n.useEffect)(()=>{let e=localStorage.getItem("username");e&&u(e)},[]);let p=()=>{c(!i)},x=()=>{d(!o)},f=e=>{"LOGOUT"===e?t():"CATALOGUE REQUEST"===e?h.push("/customers/catalogueRequest"):"ORDER"===e&&h.push("/customers/newOrder"),c(!1),d(!1)};return(0,l.jsxs)("header",{className:"col-span-12 bg-darkpurple text-white p-4 flex justify-between items-center",children:[(0,l.jsx)("div",{children:(0,l.jsx)("span",{className:"material-symbols-sharp text-3xl cursor-pointer hover:text-lightpurple",onClick:s,children:"menu"})}),(0,l.jsx)("div",{children:(0,l.jsx)("h2",{className:"font-serif text-2xl font-semibold",children:"Bloms Bulbs"})}),(0,l.jsx)("nav",{className:"hidden sm:block",children:(0,l.jsx)("h2",{className:"font-semibold cursor-pointer hover:text-lightpurple",onClick:()=>{h.push("/")},children:"HOME"})}),(0,l.jsx)("nav",{className:"hidden sm:block",children:(0,l.jsx)("h2",{className:"font-semibold cursor-pointer hover:text-lightpurple",onClick:x,children:"NEW"})}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsxs)("div",{className:"px-4",children:[(0,l.jsx)("p",{children:"hello"}),(0,l.jsx)("p",{className:"text-lightpurple text-sm",children:m})]}),(0,l.jsx)("div",{className:"mr-4",children:(0,l.jsx)("span",{className:"material-symbols-sharp text-3xl cursor-pointer hover:text-lightpurple",onClick:p,children:"account_circle"})})]}),(0,l.jsx)(a,{isVisible:i,onClose:p,label:"account",children:(0,l.jsxs)("div",{className:"flex flex-col items-start py-2 mr-4 text-black",children:[(0,l.jsx)("button",{onClick:()=>f("MANAGE ACCOUNT"),className:"py-2 hover:text-lightpurple",children:"MANAGE ACCOUNT"}),(0,l.jsx)("button",{onClick:()=>f("LOGOUT"),className:"py-2 hover:text-lightpurple",children:"LOGOUT"})]})}),(0,l.jsx)(a,{isVisible:o,onClose:x,label:"new",children:(0,l.jsxs)("div",{className:"flex flex-col items-start py-2 mr-4 text-black",children:[(0,l.jsx)("button",{onClick:()=>f("CATALOGUE REQUEST"),className:"py-2 hover:text-lightpurple",children:"CATALOGUE REQUEST"}),(0,l.jsx)("button",{onClick:()=>f("ORDER"),className:"py-2 hover:text-lightpurple",children:"ORDER"})]})})]})}function c(e){let{isVisible:s,onClose:t,onLogin:r}=e,[i,c]=(0,n.useState)(""),[o,d]=(0,n.useState)(""),[m,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)([]),[x,f]=(0,n.useState)([]),[g,j]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/fetchUserNames"),s=await e.json();p(s),console.log(s)}catch(e){console.error("Failed to fetch usernames",e)}})()},[]);let N=e=>{c(e),f([]),j(!0)},b=async e=>{e.preventDefault();let s=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,password:o})}),t=await s.json();s.ok?(console.log("Token received from API:",t.token),localStorage.setItem("token",t.token),localStorage.setItem("userId",t.userId),localStorage.setItem("username",t.username),localStorage.setItem("permissionLevel",t.permissionLevel),r()):u(!0)};return(0,l.jsx)(a,{isVisible:s,onClose:t,label:"login",children:(0,l.jsxs)("div",{className:"flex flex-col items-start py-2 mr-4",children:[(0,l.jsx)("p",{className:"text-md py-2",children:"Welcome to the Bloms Bulbs Admin Suite, please enter your username and password below. If you do not know your details, please contact an administrator."}),m&&(0,l.jsx)("p",{className:"text-sm text-red pb-2",children:"PLEASE CHECK YOUR USERNAME OR PASSWORD AND TRY AGAIN"}),(0,l.jsx)("div",{className:"flex",children:x.map(e=>(0,l.jsx)("span",{className:"bg-lightpurple rounded-sm text-md p-2 mr-2 mb-2 cursor-pointer hover:text-white",onClick:()=>N(e),children:e},e))}),(0,l.jsxs)("form",{className:"grid grid-cols-6 mt-2",onSubmit:b,children:[(0,l.jsxs)("div",{className:"col-span-1 flex items-center mb-2",children:[(0,l.jsx)("label",{children:"USERNAME"}),g&&(0,l.jsx)("span",{className:"material-symbols-outlined text-lightpurple ml-2",children:"check_circle"})]}),(0,l.jsx)("div",{className:"col-span-5 flex-items-center ml-4 mb-2",children:(0,l.jsx)("input",{type:"text",value:i,onChange:e=>{let s=e.target.value;if(u(!1),c(s),s.length>0){let e=h.filter(e=>e.toLowerCase().includes(s.toLowerCase()));f(e),e.includes(s.toLowerCase())?(j(!0),f([])):j(!1)}else f([]),j(!1)},className:"p-2 rounded-sm shadow-md border focus:outline-none focus:ring-2 focus:ring-lightpurple"})}),(0,l.jsx)("div",{className:"col-span-1 flex items-center",children:(0,l.jsx)("label",{children:"PASSWORD"})}),(0,l.jsx)("div",{className:"col-span-5 flex-items-center ml-4 mb-2",children:(0,l.jsx)("input",{type:"password",value:o,onChange:e=>{u(!1),d(e.target.value)},className:"p-2 rounded-sm shadow-md border focus:outline-none focus:ring-2 focus:ring-lightpurple"})}),(0,l.jsx)("button",{className:"bg-darkpurple text-white font-medium py-2 px-4 my-2 rounded-sm hover:bg-lightpurple",type:"submit",children:"LOGIN"})]})]})})}function o(){return(0,l.jsx)("div",{className:"col-span-12 sm:col-span-2 bg-lightpurple min-h-screen",children:(0,l.jsx)("h2",{children:"SIDEBAR"})})}function d(e){let{children:s}=e,[t,r]=(0,n.useState)(!1),[a,d]=(0,n.useState)(!1),[m,u]=(0,n.useState)(!0),[h,p]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{localStorage.getItem("token")&&(r(!0),u(!1),"1"===localStorage.getItem("permissionLevel")&&d(!0))},[]),(0,n.useEffect)(()=>{let e=()=>{window.innerWidth>=1024?p(!0):p(!1)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(0,l.jsxs)("div",{className:"grid grid-cols-12",children:[!t&&(0,l.jsx)(c,{isVisible:m,onClose:()=>{},onLogin:()=>{r(!0),u(!1);let e=localStorage.getItem("token");console.log("Token from localStorage:",e),e&&"1"===localStorage.getItem("permissionLevel")&&d(!0)}}),t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i,{toggleSidebar:()=>{p(!h)},handleLogout:()=>{r(!1),d(!1),localStorage.clear(),u(!0)}}),h&&(0,l.jsx)(o,{}),(0,l.jsx)("main",{className:"p-4 ".concat(h?"col-span-10":"col-span-12"),children:s})]})]})}},2905:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return r}});var l=t(7437),n=t(9927);function r(){return(0,l.jsx)(n.default,{children:(0,l.jsx)("p",{children:"CATALOGUE REQUEST TEST"})})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=4872)}),_N_E=e.O()}]);